{% extends "base.html" %}

{% block title %}Mi Estadillo{% endblock %}

{% block content %}
<div class="grupos" id="grupo" style="overflow-x: auto; white-space: nowrap;">
    {% for grupo in grupos %}
    <div class="grupo">
        <div class="sectores">
            {% for sector in grupo.sectores %}
            <div class="sector">{{ sector }}</div>
            {% endfor %}
        </div>
        <div class="cabecera-estadillo">
            <div class="nombre">NOMBRE</div>
            <div class="horas">
                {% for hora_inicio in grupo.horas_inicio %}
                <div class="hora-inicio" style="flex: 0 0 {{ hora_inicio.porcentaje }}%;">
                    <span>{{ hora_inicio.hora_inicio }}</span>
                </div>
                {% endfor %}
            </div>
        </div>
        {% for atc in grupo.atcs %}
        <div class="atc">
            <div class="periodos">
                {% set first_active_found = false %}
                {% for periodo in atc.periodos %}
                <! {{ periodo.duracion}} {{periodo.porcentaje}}>
                    {% if periodo.activo == "ACT" and not first_active_found %}
                    {% set first_active_found = true %}
                    <div id="active-period" class="periodo periodo_{{ periodo.activo.lower()}}"
                        style="flex: 0 0 {{ periodo.porcentaje }}%; background-color: {{ periodo.color }};">
                        <span>{{ periodo.actividad }}</span>
                    </div>
                    {% else %}
                    <div class="periodo periodo_{{ periodo.activo.lower()}}"
                        style="flex: 0 0 {{ periodo.porcentaje }}%; background-color: {{ periodo.color }};">
                        <span>{{ periodo.actividad }}</span>
                    </div>
                    {% endif %}
                    {% endfor %}
            </div>
            <div class="nombre">{{ atc.nombre }}</div>
        </div>
        {% endfor %}
    </div>
    {% endfor %}
</div>
{% endblock %}

{% block scripts %}
<script>
    window.onload = function () {
        const activePeriod = document.getElementById('active-period');
        const scrollbox = document.getElementById('grupo');
        if (activePeriod && scrollbox) {
            scrollbox.scrollLeft = activePeriod.offsetLeft - scrollbox.offsetLeft;
        }
    };
</script>
{% endblock %}